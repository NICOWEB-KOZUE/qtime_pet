<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>診察状況</title>
</head>

<body>
    <h1>診察状況</h1>
    <ul>
        {% for t in tickets %}
        <li>{{ t.id }}番: {{ t.name }}</li>
        {% endfor %}
    </ul>
    <a href="/admin/next">次を呼ぶ（スタッフ用）</a>

    <ul id="queue"></ul>
    <script>
        async function refresh() {
            const r = await fetch('/status.json', { cache: 'no-store' });
            const data = await r.json();
            const ul = document.getElementById('queue');
            if (!ul) return;
            ul.innerHTML = '';
            data.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item.name;
                ul.appendChild(li);
            });
        }
        setInterval(refresh, 5000);
        refresh();
    </script>
</body>

</html>